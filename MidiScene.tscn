[gd_scene load_steps=9 format=3 uid="uid://dsjcitfq3sjeb"]

[ext_resource type="Script" uid="uid://cny5iv8sbjirt" path="res://MidiGame/MidiReader.cs" id="1_xsb4v"]
[ext_resource type="Script" uid="uid://dyw5f2xvodjl0" path="res://MidiGame/MidiCamera.cs" id="2_jxnqx"]
[ext_resource type="Script" uid="uid://caf64puaisjcu" path="res://MidiGame/MidiTrackRenderer.cs" id="3_mls7y"]
[ext_resource type="Script" uid="uid://b14myad2rx52f" path="res://MidiGame/KeyboardController.cs" id="4_1iknw"]
[ext_resource type="Script" uid="uid://tt2qlg4xxypu" path="res://MidiGame/MidiKeyboardController.cs" id="4_3pot7"]
[ext_resource type="Script" uid="uid://dx4gkvlr1i0r" path="res://MidiGame/MidiSoundPlayer.cs" id="4_kjjcl"]
[ext_resource type="Script" uid="uid://df2hst5nekh01" path="res://MidiGame/PianoUI/PianoUIController.cs" id="6_kesap"]
[ext_resource type="Script" uid="uid://cj1y3yiafofum" path="res://MidiGame/SoundfontConfigUI.cs" id="7_04x8u"]

[node name="MIDIScene" type="Node"]

[node name="MidiReader" type="Node" parent="." node_paths=PackedStringArray("renderer")]
script = ExtResource("1_xsb4v")
renderer = NodePath("../MidiTrackRenderer")

[node name="Camera2D" type="Camera2D" parent="."]
position = Vector2(0, 5)
script = ExtResource("2_jxnqx")

[node name="MidiTrackRenderer" type="Node2D" parent="."]
script = ExtResource("3_mls7y")

[node name="MidiKeyboardController" type="Node" parent="."]
script = ExtResource("4_3pot7")

[node name="KeyboardController" type="Node" parent="."]
script = ExtResource("4_1iknw")

[node name="CanvasLayer" type="CanvasLayer" parent="."]

[node name="SoundFontConfigUI" type="Control" parent="CanvasLayer" node_paths=PackedStringArray("container", "octavesLabel", "octaveUpButton", "octaveDownButton", "transposeLabel", "transposeUpButton", "transposeDownButton", "hideButton")]
layout_mode = 3
anchors_preset = 0
offset_right = 40.0
offset_bottom = 40.0
script = ExtResource("7_04x8u")
container = NodePath("../MarginContainer")
octavesLabel = NodePath("../MarginContainer/LeftPanel/OctaveControls/OctaveLabel")
octaveUpButton = NodePath("../MarginContainer/LeftPanel/OctaveControls/OctaveUp")
octaveDownButton = NodePath("../MarginContainer/LeftPanel/OctaveControls/OctaveDown")
transposeLabel = NodePath("../MarginContainer/LeftPanel/TransposeControls/TransposeLabel")
transposeUpButton = NodePath("../MarginContainer/LeftPanel/TransposeControls/TransposeUp")
transposeDownButton = NodePath("../MarginContainer/LeftPanel/TransposeControls/TransposeDown")
hideButton = NodePath("../MarginContainer/LeftPanel/HideButton")

[node name="MarginContainer" type="MarginContainer" parent="CanvasLayer"]
offset_right = 40.0
offset_bottom = 40.0
theme_override_constants/margin_left = 10
theme_override_constants/margin_top = 10
theme_override_constants/margin_right = 10
theme_override_constants/margin_bottom = 10

[node name="LeftPanel" type="VBoxContainer" parent="CanvasLayer/MarginContainer"]
layout_mode = 2
theme_override_constants/separation = 10

[node name="TransposeLabel" type="Label" parent="CanvasLayer/MarginContainer/LeftPanel"]
layout_mode = 2
size_flags_horizontal = 3
size_flags_vertical = 3
text = "Transpose"
horizontal_alignment = 1
vertical_alignment = 1

[node name="TransposeControls" type="HBoxContainer" parent="CanvasLayer/MarginContainer/LeftPanel"]
layout_mode = 2
size_flags_vertical = 3

[node name="TransposeDown" type="Button" parent="CanvasLayer/MarginContainer/LeftPanel/TransposeControls"]
layout_direction = 2
layout_mode = 2
size_flags_horizontal = 3
text = "-"

[node name="TransposeLabel" type="Label" parent="CanvasLayer/MarginContainer/LeftPanel/TransposeControls"]
layout_mode = 2
size_flags_horizontal = 3
horizontal_alignment = 1
vertical_alignment = 1

[node name="TransposeUp" type="Button" parent="CanvasLayer/MarginContainer/LeftPanel/TransposeControls"]
layout_direction = 3
layout_mode = 2
size_flags_horizontal = 3
text = "+"

[node name="OctaveLabel" type="Label" parent="CanvasLayer/MarginContainer/LeftPanel"]
layout_mode = 2
size_flags_horizontal = 3
size_flags_vertical = 3
text = "Octave"
horizontal_alignment = 1
vertical_alignment = 1

[node name="OctaveControls" type="HBoxContainer" parent="CanvasLayer/MarginContainer/LeftPanel"]
layout_mode = 2
size_flags_vertical = 3

[node name="OctaveDown" type="Button" parent="CanvasLayer/MarginContainer/LeftPanel/OctaveControls"]
layout_direction = 2
layout_mode = 2
size_flags_horizontal = 3
text = "-"

[node name="OctaveLabel" type="Label" parent="CanvasLayer/MarginContainer/LeftPanel/OctaveControls"]
layout_mode = 2
size_flags_horizontal = 3
horizontal_alignment = 1
vertical_alignment = 1

[node name="OctaveUp" type="Button" parent="CanvasLayer/MarginContainer/LeftPanel/OctaveControls"]
layout_direction = 3
layout_mode = 2
size_flags_horizontal = 3
text = "+"

[node name="InstrumentDropdown" type="OptionButton" parent="CanvasLayer/MarginContainer/LeftPanel"]
layout_mode = 2
item_count = 1
popup/item_0/text = "Test"
popup/item_0/id = 0

[node name="HideButton" type="Button" parent="CanvasLayer/MarginContainer/LeftPanel"]
layout_mode = 2
size_flags_vertical = 0
text = "Hide/Show
"

[node name="PianoController" type="Control" parent="CanvasLayer"]
layout_mode = 3
anchors_preset = 0
offset_right = 40.0
offset_bottom = 40.0
script = ExtResource("6_kesap")
pianoKeyScene = "res://MidiGame/PianoUI/PianoKeyScene.tscn"

[node name="MidiSoundPlayer" type="Node" parent="." node_paths=PackedStringArray("pianoController", "instrumentOptions", "keyboardController", "soundfontConfigUI", "midiInputController")]
script = ExtResource("4_kjjcl")
pianoController = NodePath("../CanvasLayer/PianoController")
instrumentOptions = NodePath("../CanvasLayer/MarginContainer/LeftPanel/InstrumentDropdown")
keyboardController = NodePath("../KeyboardController")
soundfontConfigUI = NodePath("../CanvasLayer/SoundFontConfigUI")
midiInputController = NodePath("../MidiKeyboardController")
_soundfontPath = "res://soundfonts/Arachno_SoundFont_Version_1.0.sf2"
_midiPath = "res://midi/zeldalullaby.mid"
